/*
 * Bonvelo
 * Bonvelo - En marknadsplats för bra cyklar.
 * www.bonvelo.io
 * @author Mattias Haal
 * @version 0.1.0
 * Copyright 2015. Licensed licensed.
 */
function ajax(t,e,n){var o=null;o=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),o.onreadystatechange=function(){(4===o.readyState||"complete"===o.readyState)&&(200===o.status?e(o):console.log("Fel på servern"))},o.open("POST",t,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(n)}function addEvent(t,e,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e[t]=n}function toggle(t){var e=document.querySelector(t);e.classList.toggle("active")}function EditStatus(t){this.postStartStatus=document.querySelector(".post_start--"+t),null!=this.postStartStatus&&(this.postStatus=document.querySelector(".post_"+t),this.postCancelStatus=document.querySelector(".post_cancel--"+t),this.postStartStatus&&addEvent("click",this.postStartStatus,function(e){e.preventDefault(),toggle(".post_"+t+"-bg")}),this.postCancelStatus&&addEvent("click",this.postCancelStatus,function(e){e.preventDefault(),toggle(".post_"+t+"-bg")}),this.postStatus&&addEvent("submit",this.postStatus,function(t){t.preventDefault()}))}function Dropdown(t){if(this.btn=document.querySelector(".js-"+t+"-btn"),null!=this.btn){this.list=document.querySelector(".js-"+t+"-list"),this.items=document.querySelectorAll(".js-"+t+"-item"),this.data="data-"+t,this.placeholder=this.btn.children[1],this.inputData=this.btn.children[2],addEvent("click",this.list,function(t){return function(){t.btn.classList.toggle("active"),t.list.classList.toggle("active")}}(this)),addEvent("click",this.btn,function(e){return function(){e.toggle(".js-"+t+"-btn"),e.toggle(".js-"+t+"-list")}}(this));for(var e=0;e<this.items.length;e++){var n=this.items[e];addEvent("click",n,function(t){return function(){var e=this.innerText,n=this.getAttribute(t.data);t.placeholder.innerText=e,t.inputData.value=n}}(this))}}Dropdown.prototype.toggle=function(t){var e=document.querySelector(t);e.classList.toggle("active")},Dropdown.prototype.remove=function(t){var e=document.querySelector(t);e.classList.remove("active")},Dropdown.prototype.add=function(t){var e=document.querySelector(t);e.classList.add("active")}}!function(){var t=document.querySelector(".js-spec");t&&addEvent("click",t,function(){toggle(".js-spec"),toggle(".post_spec")})}(),function(){new EditStatus("draft")}(),function(){new EditStatus("delete")}(),function(){new EditStatus("publish")}(),function(){new EditStatus("email")}(),function(){new Dropdown("category")}(),function(){new Dropdown("brand")}(),function(){new Dropdown("size")}(),function(){new Dropdown("region")}(),function(){function t(){o.style.height="auto",o.style.height=o.scrollHeight+"px"}function e(){i.style.height="auto",i.style.height=i.scrollHeight+"px"}function n(){window.setTimeout(t,0),window.setTimeout(e,0)}var o=document.querySelector(".post_title");o&&(addEvent("change",o,t),addEvent("cut",o,n),addEvent("paste",o,n),addEvent("drop",o,n),addEvent("keydown",o,n),o.focus(),o.select()),t();var i=document.querySelector(".post_text");i&&(addEvent("change",i,e),addEvent("cut",i,n),addEvent("paste",i,n),addEvent("drop",i,n),addEvent("keydown",i,n),i.focus(),i.select()),e()}(),$(function(){$(".post_file--upload").on("change",function(){var t=this.files?this.files:[];if(t.length&&window.FileReader&&/^image/.test(t[0].type)){var e=new FileReader;e.readAsDataURL(t[0]),e.onloadend=function(){$(".post_file--preview").attr("src",this.result),$(function(){$(".item").matchHeight()})}}})});